<%= form_with model: @topic, class: '' do |f| %>
  <div class="space-y-8 divide-y divide-gray-200">
    <div>
      <div>
        <h3 class="text-lg leading-6 font-medium text-gray-900">Details</h3>
        <p class="mt-1 text-sm text-gray-500">The details about this particular topic.</p>
      </div>
      <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
        <div class="sm:col-span-4">
          <%= f.label :name, "Name", class: "block text-sm font-medium text-gray-700"%>
          <div class="mt-1">
            <%= f.text_field :name, class: 'flex-1 focus:ring-violet-500 focus:border-violet-500 block w-full min-w-0 rounded-md shadow-sm sm:text-sm border-gray-300' %>
          </div>
        </div>
        <% if @topic.persisted? %>
          <div class="sm:col-span-4">
            <%= label_tag :query, "Query", class: "block text-sm font-medium text-gray-700"%>
            <div class="mt-1">
              <span class="bg-gray-100 inline-block p-2 text-purple-500 font-mono w-full text-sm"><%= @topic.search_phrase %></span>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <div class="pt-8">
      <div>
        <h3 class="text-lg leading-6 font-medium text-gray-900">Keywords</h3>
        <p class="mt-1 text-sm text-gray-500">Keywords to include in the search.</p>
      </div>
      <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
        <%= f.fields_for :search_terms do |term_form| %>
          <div class="sm:col-span-4">
            <%= term_form.text_field :term, class: 'flex-1 focus:ring-violet-500 focus:border-violet-500 block w-full min-w-0 rounded-md shadow-sm sm:text-sm border-gray-300' %>
            <div class="flex items-center mt-2 space-x-4">
              <div class="relative flex items-start">
                <div class="flex items-center h-5">
                  <%= term_form.check_box :exact_match, class: 'focus:ring-violet-500 h-4 w-4 text-violet-600 border-gray-300 rounded' %>
                </div>
                <div class="ml-3 text-sm">
                  <%= term_form.label :exact_match, "Exact match", class: 'font-medium text-gray-700' %>
                </div>
              </div>
              <div class="relative flex items-start">
                <div class="flex items-center h-5">
                  <%= term_form.check_box :required, class: 'focus:ring-violet-500 h-4 w-4 text-violet-600 border-gray-300 rounded' %>
                </div>
                <div class="ml-3 text-sm">
                  <%= term_form.label :required, "Required", class: 'font-medium text-gray-700' %>
                </div>
              </div>
            </div>
          </div>
        <% end %>

      </div>
    </div>
    <div class="pt-8">
      <div>
        <h3 class="text-lg leading-6 font-medium text-gray-900">Search modifiers</h3>
        <p class="mt-1 text-sm text-gray-500">Optional modifiers that can help narrow the scope of your search.</p>
      </div>
      <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
        <div class="sm:col-span-4">
          <%= f.label :filter_by_language, "Language filter", class: "block text-sm font-medium text-gray-700"%>
          <div class="mt-1">
            <%= f.select :filter_by_language, options_for_select([['All Languages', ''], ['English', 'en']], @topic.filter_by_language), {}, class: 'mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md' %>
          </div>
        </div>
        <div class="sm:col-span-4">
          <fieldset>
            <legend class="sr-only">Required attributes</legend>
            <div class="text-base font-medium text-gray-900" aria-hidden="true">Required attributes</div>
            <div class="mt-4 space-y-4">
              <div class="relative flex items-start">
                <div class="flex items-center h-5">
                  <%= f.check_box :require_links, class: 'focus:ring-violet-500 h-4 w-4 text-violet-600 border-gray-300 rounded' %>
                </div>
                <div class="ml-3 text-sm">
                  <%= f.label :require_links, "Require links", class: 'font-medium text-gray-700' %>
                  <p class="text-gray-500">Require tweets to include links.</p>
                </div>
              </div>
              <div class="relative flex items-start">
                <div class="flex items-center h-5">
                  <%= f.check_box :require_images, class: 'focus:ring-violet-500 h-4 w-4 text-violet-600 border-gray-300 rounded' %>
                </div>
                <div class="ml-3 text-sm">
                  <%= f.label :require_images, "Require images", class: 'font-medium text-gray-700' %>
                  <p class="text-gray-500">Require tweets to include images.</p>
                </div>
              </div>
              <div class="relative flex items-start">
                <div class="flex items-center h-5">
                  <%= f.check_box :require_media, class: 'focus:ring-violet-500 h-4 w-4 text-violet-600 border-gray-300 rounded' %>
                </div>
                <div class="ml-3 text-sm">
                  <%= f.label :require_media, "Require media", class: 'font-medium text-gray-700' %>
                  <p class="text-gray-500">Require tweets to include a media object such as an image, GIF, or video.</p>
                </div>
              </div>
              <div class="relative flex items-start">
                <div class="flex items-center h-5">
                  <%= f.check_box :require_verified, class: 'focus:ring-violet-500 h-4 w-4 text-violet-600 border-gray-300 rounded' %>
                </div>
                <div class="ml-3 text-sm">
                  <%= f.label :require_verified, "Require verfied tweeters", class: 'font-medium text-gray-700' %>
                  <p class="text-gray-500">Require tweets to be sent by verified Twitter users.</p>
                </div>
              </div>
            </div>
          </fieldset>
        </div>
        <div class="sm:col-span-4">
          <fieldset>
            <legend class="sr-only">Ignored attributes</legend>
            <div class="text-base font-medium text-gray-900" aria-hidden="true">Ignored attributes</div>
            <div class="mt-4 space-y-4">
              <div class="relative flex items-start">
                <div class="flex items-center h-5">
                  <%= f.check_box :ignore_ads, class: 'focus:ring-violet-500 h-4 w-4 text-violet-600 border-gray-300 rounded' %>
                </div>
                <div class="ml-3 text-sm">
                  <%= f.label :ignore_ads, "Ignore ads", class: 'font-medium text-gray-700' %>
                  <p class="text-gray-500">Ignore tweets that were sent as promotional tweets.</p>
                </div>
              </div>
            </div>
          </fieldset>
        </div>
      </div>
    </div>
    <div class="pt-8">
      <div>
        <h3 class="text-lg leading-6 font-medium text-gray-900">Negative keywords</h3>
        <p class="mt-1 text-sm text-gray-500">Optional negative keywords to help restrict irrelevant search results.</p>
      </div>
      <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
        <%= f.fields_for :negative_search_terms do |term_form| %>
          <div class="sm:col-span-4">
            <%= term_form.text_field :term, class: 'flex-1 focus:ring-violet-500 focus:border-violet-500 block w-full min-w-0 rounded-md shadow-sm sm:text-sm border-gray-300' %>
          </div>
        <% end %>
        <% if @topic.persisted? %>
          <div class="sm:col-span-4">
            <%= f.fields_for @topic.negative_search_terms.build do |new_term| %>
              <%= new_term.text_field :term, class: 'flex-1 focus:ring-violet-500 focus:border-violet-500 block w-full min-w-0 rounded-md shadow-sm sm:text-sm border-gray-300' %>
            <% end %>
          </div>
        <% else %>
          <% 3.times do %>
            <div class="sm:col-span-4">
              <%= f.fields_for :new_negative_search_terms do |search_term_builder| %>
                <%= search_term_builder.label 'Negative keyword', class: 'sr-only' %>
                <%= search_term_builder.text_field '', class: 'flex-1 focus:ring-violet-500 focus:border-violet-500 block w-full min-w-0 rounded-md shadow-sm sm:text-sm border-gray-300' %>
              <% end %>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
    <div class="pt-8">
      <div>
        <h3 class="text-lg leading-6 font-medium text-gray-900">Scoring threshold</h3>
        <p class="mt-1 text-sm text-gray-500">Optional scoring threshold to help filter out low-quality tweets based on a simple scoring formula (<span class="font-mono text-xs p-1 text-pink-500 bg-gray-100">(impressions + (likes * 5) + (retweets * 20))</span>).</p>
      </div>
      <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
        <div class="sm:col-span-4">
          <%= f.label :threshold, "Minimum score", class: "block text-sm font-medium text-gray-700"%>
          <div class="mt-1">
            <%= f.number_field :threshold, step: :any, class: 'mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md' %>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="pt-5">
    <div class="flex justify-end">
      <%= link_to "Cancel", cancel_link, class: 'bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500' %>
      <button type="submit" class="ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-violet-600 hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500">Save</button>
    </div>
  </div>
<% end %>
